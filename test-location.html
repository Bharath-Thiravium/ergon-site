<!DOCTYPE html>
<html>
<head>
    <title>Location Test</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .result { margin: 10px 0; padding: 10px; border: 1px solid #ddd; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        button { padding: 10px 20px; margin: 5px; font-size: 16px; }
    </style>
</head>
<body>
    <h1>Geolocation Debug Test</h1>
    <button onclick="testQuick()">Test Quick (3s)</button>
    <button onclick="testCached()">Test Cached (5min)</button>
    <button onclick="testInstant()">Test Instant (Infinity cache)</button>
    <div id="results"></div>

    <script>
        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = 'result ' + type;
            div.innerHTML = new Date().toLocaleTimeString() + ' - ' + msg;
            document.getElementById('results').prepend(div);
        }

        function testQuick() {
            log('Testing quick mode (3s timeout)...');
            const start = Date.now();
            navigator.geolocation.getCurrentPosition(
                pos => log(`✅ SUCCESS in ${Date.now()-start}ms: ${pos.coords.latitude}, ${pos.coords.longitude}`, 'success'),
                err => log(`❌ ERROR in ${Date.now()-start}ms: ${err.message} (code: ${err.code})`, 'error'),
                { enableHighAccuracy: false, timeout: 3000, maximumAge: 0 }
            );
        }

        function testCached() {
            log('Testing cached mode (5min cache)...');
            const start = Date.now();
            navigator.geolocation.getCurrentPosition(
                pos => log(`✅ SUCCESS in ${Date.now()-start}ms: ${pos.coords.latitude}, ${pos.coords.longitude}`, 'success'),
                err => log(`❌ ERROR in ${Date.now()-start}ms: ${err.message} (code: ${err.code})`, 'error'),
                { enableHighAccuracy: false, timeout: 3000, maximumAge: 300000 }
            );
        }

        function testInstant() {
            log('Testing instant mode (infinite cache)...');
            const start = Date.now();
            navigator.geolocation.getCurrentPosition(
                pos => log(`✅ SUCCESS in ${Date.now()-start}ms: ${pos.coords.latitude}, ${pos.coords.longitude}`, 'success'),
                err => log(`❌ ERROR in ${Date.now()-start}ms: ${err.message} (code: ${err.code})`, 'error'),
                { enableHighAccuracy: false, timeout: 1000, maximumAge: Infinity }
            );
        }

        // Auto-run instant test on load
        window.onload = () => {
            log('Page loaded. Click buttons to test different modes.');
            setTimeout(testInstant, 500);
        };
    </script>
</body>
</html>
